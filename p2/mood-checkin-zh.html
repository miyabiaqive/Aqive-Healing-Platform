<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æƒ…ç·’è¨˜éŒ„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="mountain-bg min-h-screen pb-40 overflow-y-auto">
    
    <!-- Header -->
    <div class="p-6 pt-16 flex items-center justify-between">
        <button onclick="navigate('home-zh.html')" class="w-10 h-10 rounded-full bg-white/10 backdrop-blur flex items-center justify-center">
            <i class="fas fa-arrow-left text-white"></i>
        </button>
        <h1 class="text-white text-2xl font-semibold">æƒ…ç·’è¨˜éŒ„</h1>
        <button onclick="navigate('home-zh.html')" class="w-10 h-10 rounded-full bg-white/10 backdrop-blur flex items-center justify-center">
            <i class="fas fa-times text-white"></i>
        </button>
    </div>

    <!-- Question -->
    <div class="px-6 mt-6">
        <h2 class="text-white text-2xl font-bold mb-2">ä»Šå¤©æ„Ÿè¦ºå¦‚ä½•ï¼Ÿ</h2>
        <p class="text-white/70 text-sm mb-6">é¸æ“‡æœ€è²¼è¿‘ä½ æ­¤åˆ»æ„Ÿå—çš„æƒ…ç·’</p>
        
        <!-- Mood Selection -->
        <div class="grid grid-cols-5 gap-3 mb-6">
            <button onclick="selectMood('å¾ˆå¥½', 'ğŸ˜„')" class="mood-option" data-mood="å¾ˆå¥½">
                <span class="text-4xl mb-2">ğŸ˜„</span>
                <span class="text-white text-xs">å¾ˆå¥½</span>
            </button>
            <button onclick="selectMood('æ„‰å¿«', 'ğŸ˜Š')" class="mood-option" data-mood="æ„‰å¿«">
                <span class="text-4xl mb-2">ğŸ˜Š</span>
                <span class="text-white text-xs">æ„‰å¿«</span>
            </button>
            <button onclick="selectMood('å¹³éœ', 'ğŸ˜Œ')" class="mood-option" data-mood="å¹³éœ">
                <span class="text-4xl mb-2">ğŸ˜Œ</span>
                <span class="text-white text-xs">å¹³éœ</span>
            </button>
            <button onclick="selectMood('ç–²æ†Š', 'ğŸ˜”')" class="mood-option" data-mood="ç–²æ†Š">
                <span class="text-4xl mb-2">ğŸ˜”</span>
                <span class="text-white text-xs">ç–²æ†Š</span>
            </button>
            <button onclick="selectMood('ç„¦æ…®', 'ğŸ˜°')" class="mood-option" data-mood="ç„¦æ…®">
                <span class="text-4xl mb-2">ğŸ˜°</span>
                <span class="text-white text-xs">ç„¦æ…®</span>
            </button>
        </div>
    </div>

    <!-- Body Signals -->
    <div class="px-6 mt-6">
        <h3 class="text-white text-lg font-semibold mb-4">èº«é«”è¨Šè™Ÿ</h3>
        <div class="glass-card rounded-3xl p-6">
            <p class="text-white/80 text-sm mb-4">æœ‰æ„Ÿå—åˆ°ä»¥ä¸‹ç—‡ç‹€å—ï¼Ÿï¼ˆå¯å¤šé¸ï¼‰</p>
            <div class="grid grid-cols-2 gap-3">
                <button onclick="toggleBodySignal('é ­ç—›')" class="body-signal-btn" data-signal="é ­ç—›">
                    <span class="text-xl mr-2">ğŸ¤•</span>
                    <span>é ­ç—›</span>
                </button>
                <button onclick="toggleBodySignal('è‚Œè‚‰ç·Šç¹ƒ')" class="body-signal-btn" data-signal="è‚Œè‚‰ç·Šç¹ƒ">
                    <span class="text-xl mr-2">ğŸ’ª</span>
                    <span>è‚Œè‚‰ç·Šç¹ƒ</span>
                </button>
                <button onclick="toggleBodySignal('å¿ƒè·³åŠ é€Ÿ')" class="body-signal-btn" data-signal="å¿ƒè·³åŠ é€Ÿ">
                    <span class="text-xl mr-2">ğŸ’“</span>
                    <span>å¿ƒè·³åŠ é€Ÿ</span>
                </button>
                <button onclick="toggleBodySignal('å‘¼å¸æ€¥ä¿ƒ')" class="body-signal-btn" data-signal="å‘¼å¸æ€¥ä¿ƒ">
                    <span class="text-xl mr-2">ğŸ˜®â€ğŸ’¨</span>
                    <span>å‘¼å¸æ€¥ä¿ƒ</span>
                </button>
                <button onclick="toggleBodySignal('èƒƒéƒ¨ä¸é©')" class="body-signal-btn" data-signal="èƒƒéƒ¨ä¸é©">
                    <span class="text-xl mr-2">ğŸ¤¢</span>
                    <span>èƒƒéƒ¨ä¸é©</span>
                </button>
                <button onclick="toggleBodySignal('ç–²å‹ç„¡åŠ›')" class="body-signal-btn" data-signal="ç–²å‹ç„¡åŠ›">
                    <span class="text-xl mr-2">ğŸ˜´</span>
                    <span>ç–²å‹ç„¡åŠ›</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Stress Triggers -->
    <div class="px-6 mt-6">
        <h3 class="text-white text-lg font-semibold mb-4">å£“åŠ›ä¾†æº</h3>
        <div class="glass-card rounded-3xl p-6">
            <p class="text-white/80 text-sm mb-4">ä»€éº¼è®“ä½ æœ‰å£“åŠ›ï¼Ÿï¼ˆå¯å¤šé¸ï¼‰</p>
            <div class="flex flex-wrap gap-2">
                <button onclick="toggleTrigger('å·¥ä½œä»»å‹™')" class="trigger-btn" data-trigger="å·¥ä½œä»»å‹™">
                    ğŸ’¼ å·¥ä½œä»»å‹™
                </button>
                <button onclick="toggleTrigger('äººéš›é—œä¿‚')" class="trigger-btn" data-trigger="äººéš›é—œä¿‚">
                    ğŸ‘¥ äººéš›é—œä¿‚
                </button>
                <button onclick="toggleTrigger('æ™‚é–“å£“åŠ›')" class="trigger-btn" data-trigger="æ™‚é–“å£“åŠ›">
                    â° æ™‚é–“å£“åŠ›
                </button>
                <button onclick="toggleTrigger('è²¡å‹™å£“åŠ›')" class="trigger-btn" data-trigger="è²¡å‹™å£“åŠ›">
                    ğŸ’° è²¡å‹™å£“åŠ›
                </button>
                <button onclick="toggleTrigger('å¥åº·å•é¡Œ')" class="trigger-btn" data-trigger="å¥åº·å•é¡Œ">
                    ğŸ¥ å¥åº·å•é¡Œ
                </button>
                <button onclick="toggleTrigger('å®¶åº­äº‹å‹™')" class="trigger-btn" data-trigger="å®¶åº­äº‹å‹™">
                    ğŸ  å®¶åº­äº‹å‹™
                </button>
                <button onclick="toggleTrigger('æ±ºç­–å›°æ“¾')" class="trigger-btn" data-trigger="æ±ºç­–å›°æ“¾">
                    ğŸ¤” æ±ºç­–å›°æ“¾
                </button>
                <button onclick="toggleTrigger('å…¶ä»–')" class="trigger-btn" data-trigger="å…¶ä»–">
                    â­ å…¶ä»–
                </button>
            </div>
        </div>
    </div>

    <!-- Notes -->
    <div class="px-6 mt-6">
        <h3 class="text-white text-lg font-semibold mb-4">å¿ƒæƒ…ç­†è¨˜ï¼ˆé¸å¡«ï¼‰</h3>
        <div class="glass-card rounded-3xl p-6">
            <textarea 
                id="mood-notes" 
                placeholder="å¯«ä¸‹ä»Šå¤©ç™¼ç”Ÿçš„äº‹æˆ–ä½ çš„æƒ³æ³•..." 
                class="w-full bg-white/10 text-white rounded-2xl p-4 min-h-[120px] focus:outline-none focus:ring-2 focus:ring-white/50 placeholder-white/40"
            ></textarea>
        </div>
    </div>

    <!-- Save Button -->
    <div class="px-6 mt-6 pb-8">
        <button onclick="saveMoodEntry()" class="w-full bg-white text-purple-600 rounded-full py-4 font-semibold text-lg shadow-lg hover:shadow-xl transition-all hover:scale-105">
            å„²å­˜ä»Šæ—¥è¨˜éŒ„
        </button>
    </div>

    <!-- Week Calendar -->
    <div class="px-6 mt-6">
        <div class="glass-card rounded-3xl p-6">
            <h3 class="text-white text-lg font-semibold mb-4">8æœˆç¬¬1é€±</h3>
            <div class="grid grid-cols-7 gap-2 mb-4">
                <div class="text-center">
                    <p class="text-white/60 text-xs mb-2">ä¸€</p>
                    <div class="calendar-day active">
                        <span class="mood-emoji text-xl">ğŸ˜Š</span>
                    </div>
                    <p class="text-white text-xs mt-1">3</p>
                </div>
                <div class="text-center">
                    <p class="text-white/60 text-xs mb-2">äºŒ</p>
                    <div class="calendar-day">
                        <span class="text-white/40">4</span>
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-white/60 text-xs mb-2">ä¸‰</p>
                    <div class="calendar-day">
                        <span class="text-white/40">5</span>
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-white/60 text-xs mb-2">å››</p>
                    <div class="calendar-day">
                        <span class="text-white/40">6</span>
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-white/60 text-xs mb-2">äº”</p>
                    <div class="calendar-day">
                        <span class="text-white/40">7</span>
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-white/60 text-xs mb-2">å…­</p>
                    <div class="calendar-day">
                        <span class="text-white/40">8</span>
                    </div>
                </div>
                <div class="text-center">
                    <p class="text-white/60 text-xs mb-2">æ—¥</p>
                    <div class="calendar-day">
                        <span class="text-white/40">9</span>
                    </div>
                </div>
            </div>
            <button class="text-white/80 text-sm font-medium">æŸ¥çœ‹æ­·å²è¨˜éŒ„</button>
        </div>
    </div>

    <!-- Recommended -->
    <div class="px-6 mt-6 pb-24">
        <h2 class="text-white text-xl font-semibold mb-4">ç‚ºä½ æ¨è–¦</h2>
        <div class="grid grid-cols-2 gap-4">
            <div onclick="navigate('player-zh.html')" class="content-card" style="background-image: url('https://images.unsplash.com/photo-1508672019048-805c876b67e2?w=400&h=300&fit=crop')">
                <div class="content-card-info">
                    <h3 class="font-semibold text-white">å¹³éœå…§å¿ƒ</h3>
                    <p class="text-white/80 text-sm">10 åˆ†é˜</p>
                </div>
            </div>
            <div onclick="navigate('player-zh.html')" class="content-card" style="background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop')">
                <div class="content-card-info">
                    <h3 class="font-semibold text-white">æœ€ç¾è—èª¿</h3>
                    <p class="text-white/80 text-sm">10 åˆ†é˜</p>
                </div>
            </div>
            <div onclick="navigate('player-zh.html')" class="content-card" style="background-image: url('https://images.unsplash.com/photo-1511593358241-7eea1f3c84e5?w=400&h=300&fit=crop')">
                <div class="content-card-info">
                    <h3 class="font-semibold text-white">æ¯æ—¥å¹³éœ</h3>
                    <p class="text-white/80 text-sm">5 åˆ†é˜</p>
                </div>
            </div>
            <div onclick="navigate('player-zh.html')" class="content-card" style="background-image: url('https://images.unsplash.com/photo-1519681393784-d120267933ba?w=400&h=300&fit=crop')">
                <div class="content-card-info">
                    <h3 class="font-semibold text-white">å„ªè³ªç¡çœ </h3>
                    <p class="text-white/80 text-sm">15 åˆ†é˜</p>
                </div>
            </div>
        </div>
    </div>

    <style>
        .mood-option {
            @apply glass-card rounded-2xl p-3 flex flex-col items-center transition-all hover:scale-105;
        }
        .mood-option.selected {
            @apply bg-white/30 ring-2 ring-white;
        }
        .body-signal-btn, .trigger-btn {
            @apply bg-white/10 text-white rounded-full px-4 py-2 text-sm transition-all hover:bg-white/20;
        }
        .body-signal-btn.selected, .trigger-btn.selected {
            @apply bg-white text-purple-600 font-medium;
        }
    </style>

    <script>
        let moodData = {
            mood: null,
            moodEmoji: null,
            bodySignals: [],
            triggers: [],
            notes: ''
        };

        function selectMood(mood, emoji) {
            moodData.mood = mood;
            moodData.moodEmoji = emoji;
            
            // Update UI
            document.querySelectorAll('.mood-option').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.closest('.mood-option').classList.add('selected');
        }

        function toggleBodySignal(signal) {
            const btn = event.target.closest('.body-signal-btn');
            const index = moodData.bodySignals.indexOf(signal);
            
            if (index > -1) {
                moodData.bodySignals.splice(index, 1);
                btn.classList.remove('selected');
            } else {
                moodData.bodySignals.push(signal);
                btn.classList.add('selected');
            }
        }

        function toggleTrigger(trigger) {
            const btn = event.target.closest('.trigger-btn');
            const index = moodData.triggers.indexOf(trigger);
            
            if (index > -1) {
                moodData.triggers.splice(index, 1);
                btn.classList.remove('selected');
            } else {
                moodData.triggers.push(trigger);
                btn.classList.add('selected');
            }
        }

        function saveMoodEntry() {
            // Get notes
            moodData.notes = document.getElementById('mood-notes').value;
            
            // Validate
            if (!moodData.mood) {
                alert('è«‹é¸æ“‡ä½ çš„å¿ƒæƒ…');
                return;
            }
            
            // Add timestamp
            moodData.timestamp = new Date().toISOString();
            
            // Get existing entries
            const existingEntries = JSON.parse(localStorage.getItem('aqive_mood_entries') || '[]');
            
            // Add new entry
            existingEntries.push(moodData);
            
            // Save to localStorage
            localStorage.setItem('aqive_mood_entries', JSON.stringify(existingEntries));
            
            // Show success message
            showSuccessMessage();
        }

        function showSuccessMessage() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-check mr-2"></i>è¨˜éŒ„å·²å„²å­˜ï¼';
            btn.classList.add('bg-green-500', 'text-white');
            btn.classList.remove('bg-white', 'text-purple-600');
            
            setTimeout(() => {
                navigate('home-zh.html');
            }, 1500);
        }

        function navigate(page) {
            if (window.parent !== window) {
                parent.postMessage({ action: 'navigate', page: page }, '*');
            } else {
                window.location.href = page;
            }
        }

        // Load today's entry if exists
        function loadTodayEntry() {
            const today = new Date().toISOString().split('T')[0];
            const entries = JSON.parse(localStorage.getItem('aqive_mood_entries') || '[]');
            const todayEntry = entries.find(entry => entry.timestamp.startsWith(today));
            
            if (todayEntry) {
                // Pre-fill the form
                moodData = { ...todayEntry };
                
                // Select mood
                document.querySelectorAll('.mood-option').forEach(btn => {
                    if (btn.dataset.mood === todayEntry.mood) {
                        btn.classList.add('selected');
                    }
                });
                
                // Select body signals
                todayEntry.bodySignals.forEach(signal => {
                    document.querySelectorAll('.body-signal-btn').forEach(btn => {
                        if (btn.dataset.signal === signal) {
                            btn.classList.add('selected');
                        }
                    });
                });
                
                // Select triggers
                todayEntry.triggers.forEach(trigger => {
                    document.querySelectorAll('.trigger-btn').forEach(btn => {
                        if (btn.dataset.trigger === trigger) {
                            btn.classList.add('selected');
                        }
                    });
                });
                
                // Fill notes
                document.getElementById('mood-notes').value = todayEntry.notes || '';
            }
        }

        // Load on page ready
        document.addEventListener('DOMContentLoaded', loadTodayEntry);
    </script>
</body>
</html>

